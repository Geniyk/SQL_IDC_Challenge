
/* Daily Challenge:
Question: Analyze the event impact by comparing weeks with events vs weeks without events. 
Show: event status ('With Event' or 'No Event'), count of weeks, average patient satisfaction, 
and average staff morale. Order by average patient satisfaction descending. */
-- select * from services_weekly;

select 
CASE
when (event IS NULL or event = '' or event = 'none' ) then 'No Event'
Else ' With Event'
End as event_status,
count(week) as week_count,
avg(patient_satisfaction) as  average_patient_satisfaction,
avg(staff_morale) as average_staff_morale
from services_weekly
group by event_status
order by average_patient_satisfaction DESC;
