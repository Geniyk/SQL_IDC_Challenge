
/* Daily Challenge:
Question:  Identify services that refused more than 100 patients in total and had an average patient satisfaction below 80. 
Show service name, total refused, and average satisfaction..*/
-- select distinct service from services_weekly;

select service, 
round(sum(patients_refused), 2) as Total_Patients_Refused,
round(avg(patient_satisfaction), 2) as average_patient_satisfaction
from services_weekly
group by service
having sum(patients_refused) > 100 AND  avg(patient_satisfaction) < 80;

-- or

select service, 
round(sum(patients_refused),2) as Total_Patients_Refused,
round(avg(patient_satisfaction),2) as average_patient_satisfaction
from services_weekly
group by service
having Total_Patients_Refused > 100 AND  average_patient_satisfaction < 80;
