

/* Daily Challenge:
Question:Calculate the average length of stay (in days) for each service, 
showing only services where the average stay is more than 7 days. 
Also show the count of patients and order by average stay descending. */
-- select * from patients;

select service,
count(patient_id) as Patients_Count, 
round(avg(DATEDIFF(departure_date, arrival_date)),2) as Average_Stay
from patients
group by service
Having Average_Stay > 7
order by Average_Stay DESC;


-- MS SQL SERVER
select service,
count(patient_id) as Patients_Count, 
round(avg(DATEDIFF(DAY, arrival_date, departure_date)),2) as Average_Stay
from patients
group by service
Having Average_Stay > 7
order by Average_Stay DESC;
